
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Swift 的 ABI - IT Monkey Life</title>
	<meta name="author" content="Rick">

	
	<meta name="description" content="随着Swift的开源，苹果开发者迎来了新的开端。其实这个是我一直想要表达的，随着对Swift这个语言的深入了解，越发感觉到Swift的魅力。Swift是系统编程语言，现在C语言之所以能统治底层开发的最重要原因是C规范统一的ABI，使其能做到与汇编程序无缝衔接。而Swift的ABI兼容C（ &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/Blog/atom.xml" rel="alternate" title="IT Monkey Life" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/Blog/favicon.png" rel="shortcut icon">
	<link href="/Blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/Blog/">IT Monkey Life</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/Blog/">Blog</a></li>
	<li><a href="/Blog/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/Blog/">Blog</a></li>
	<li><a href="/Blog/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:ITMonkeyLife.github.io/Blog">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
    
		
		
		
		
		
		<a class="rss" href="/Blog/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:ITMonkeyLife.github.io/Blog">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Swift 的 ABI</h2>
	<div class="entry-content"><p>
随着Swift的开源，苹果开发者迎来了新的开端。其实这个是我一直想要表达的，随着对Swift这个语言的深入了解，越发感觉到Swift的魅力。Swift是系统编程语言，现在C语言之所以能统治底层开发的最重要原因是C规范统一的ABI，使其能做到与汇编程序无缝衔接。而Swift的ABI兼容C（并不包括name mangling部分）。基于强大的llvm生成具体平台代码。不仅仅作为Objective-C的翻译。
</p>
<p>
通过开发Swift，了解到Swift文件的中间编译结果（介于Swift代码合llvm ir）是SIL。SIL我下一章着重介绍。这张暂时把焦点放在Swift的ABI。那么什么是ABI，你一定很陌生吧，那么对于API呢，你是不是明白了什么？
</p>
<p>
ABI的全称是Application Binary Interface。翻译过来就是应用二进制接口，描述了应用程序和操作系统或其他应用程序之间的低级接口。
</p>
<p>
ABI涵盖了各个细节：
<!-- more-->
<ul>
<li>数据类型的大小、设计和对齐;</li>
<li>调用约定（控制着函数的参数如何传送以及如何接受返回值），例如，是所有的参数都通过栈传递，还是部分参数通过寄存器传递；哪个寄存器用于哪个函数参数；通过栈传递的第一个函数参数是最先push到栈上还是最后</li>
<li>系统调用的编码和一个应用如何向操作系统进行系统调用</li>
<li>以及在一个完整的操作系统ABI中，目标文件的二进制格式、程序库等等。</li>
</ul>
一个完整的ABI，像Intel二进制兼容标准（iBCS），允许支持它的操作系统上的程序不经修改在其他支持此ABI的操作系统上运行。
</p>
<p>
ABI不同于应用程序接口（API），API定义了源代码和库之间的接口，因此同样的代码可以在支持这个API的任何系统中编译，然而ABI允许编译好的目标代码在使用兼容ABI的系统中无需改动就能运行。 在Unix风格的操作系统中，存在很多运行在同一硬件平台上互相相关但是不兼容的操作系统（尤其是Intel 80386兼容系统）。有一些努力尝试标准化ABI，以减少销售商将程序移植到其他系统时所需的工作。然而，直到现在还没有很成功的例子，虽然Linux标准化工作组正在为Linux做这方面的努力。
</p>
<p>
我在上面说了，ABI的各个细节。在这我需要强调一点：在Swift类，如果没有明确标识对象基类则一律继承SwiftObject Objective-C类。这个是Swift的硬性规定。
</p>
<h2>类型设计</h2>
<h4>脆弱的结构体和元组设计</h4>
<p>
结构和元组目前共享相同的设计算法，编译器实现“通用”设计算法。该算法如下：
<ul>
  <li>从0开始，以1对齐增长</li>
  <li>遍历字段,在元素的元组,或顺序结构var声明。每个字段:<ul>
      <li>通过舍入更新字节来对齐字段，字段增长的值至少大于或等于字节，整除的一致性</li>
      <li>&lt;字段的当前值的大小赋给偏移量/li&gt;
      <li>更新字节通过添加字段的字节大小</li>
      <li>更新对齐最大字节，和更新对齐的字段</li>
      
  </li>
  <li>最终的大小和对齐的大小和对齐集合。类型是最后的，步长大小来对齐。</li>
</ul>

注意这不同于C或LLVM是正常的设计规则,大小和步幅是不同的,而C设计要求,嵌入式结构的大小是填充其对齐,迅速设计允许外部结构布置内部结构的尾巴填充字段,允许对齐。与C不同,大小结构和元组也允许,没有存储在包含总量。快速编译器发出LLVM包装结构类型与手动填充必要的控制二进制设计。一些例子:
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="c1">// LLVM &lt;{ i64, i8 }&gt;</span>
</span><span class="line"><span class="k">struct</span> <span class="n">S</span> <span class="p">{</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">x:</span> <span class="n">Int</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">y:</span> <span class="n">UInt8</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// LLVM &lt;{ i8, [7 x i8], &lt;{ i64, i8 }&gt;, i8 }&gt;</span>
</span><span class="line"><span class="k">struct</span> <span class="n">S2</span> <span class="p">{</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">x:</span> <span class="n">UInt8</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">s:</span> <span class="n">S</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">y:</span> <span class="n">UInt8</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// LLVM &lt;{}&gt;</span>
</span><span class="line"><span class="k">struct</span> <span class="n">Empty</span> <span class="p">{}</span>
</span><span class="line">
</span><span class="line"><span class="c1">// LLVM &lt;{ i64, i64 }&gt;</span>
</span><span class="line"><span class="k">struct</span> <span class="n">ContainsEmpty</span> <span class="p">{</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">x:</span> <span class="n">Int</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">y:</span> <span class="n">Empty</span>
</span><span class="line">  <span class="n">var</span> <span class="nl">z:</span> <span class="n">Int</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>


<h4>类设计</h4>
<p>
Swift依赖下面的关于Objective-C运行时的假设，是Objective-C ABI的一部分：
<ul>
<li>32位平台从未标记指针。ObjC指针类型是nil或一个对象指针。</li>
<li>在x86-64,一个标记指针设置指针的最低位或最高位的指针。因此,这两位都是0当且仅当该值不是一个标记指针。</li>
<li>ARM64,标记指针总是设置最高位的指针。</li>
<li>32位平台不会执行任何isa掩饰<code>object_getClass</code>总是相当于<code>*(Class*)object</code></li>
<li>64位平台上执行isa掩饰只有在运行时才导出的符号<code>uintptr_t objc_debug_isa_class_mask;</code>。如果导出这个符号，<code>object_getClass</code>在一个非标记指针总是相当于<code>(Class)(objc_debug_isa_class_mask &amp; *(uintptr_t*)object)</code></li>
<li>超类的类对象总是isa字段后立即存储。它的值是nil或一个指向父类的类对象;它从来没有其他设置。</li>
</ul>

下面是Swift ABI的一部分：
<ul>
<li>Swift指针不会是标记指针。</li>
</ul>
</p>

<h2>脆弱的Enum设计</h2>
<p>
在设计enum类型、ABI试图避免需要额外存储来存储枚举的标签。ABI选择的五个策略基于enum的设计:
</p>
<h4>空枚举</h4>
<p>enum在没有case的情况下,枚举是一个空的类型。
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">enum</span> <span class="n">Empty</span> <span class="p">{}</span> <span class="c1">// =&gt; empty type</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</p>
<h4>单一类型枚举</h4>
<p>只有一个情况下的枚举，没有必要筛选,和枚举类型相同的设计的情况下的数据类型,可以是空的,如果没有数据类型。
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">enum</span> <span class="n">EmptyCase</span> <span class="p">{</span> <span class="k">case</span> <span class="n">X</span> <span class="p">}</span>             <span class="c1">// =&gt; empty type</span>
</span><span class="line"><span class="k">enum</span> <span class="n">DataCase</span> <span class="p">{</span> <span class="k">case</span> <span class="n">Y</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Double</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// =&gt; LLVM &lt;{ i64, double }&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</p>
<h4>类C枚举</h4>
<p>如果没有一个case有数据类型(一个典型的“c”enum),那么enum是最小整数标记包含的比特数的所有情况。遵循LLVM的数据设计规则整数类型在目标平台上。被分配的case标签的值依次排列声明顺序。
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">enum</span> <span class="n">EnumLike2</span> <span class="p">{</span> <span class="c1">// =&gt; LLVM i1</span>
</span><span class="line">  <span class="k">case</span> <span class="n">A</span>         <span class="c1">// =&gt; i1 0</span>
</span><span class="line">  <span class="k">case</span> <span class="n">B</span>         <span class="c1">// =&gt; i1 1</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="k">enum</span> <span class="n">EnumLike8</span> <span class="p">{</span> <span class="c1">// =&gt; LLVM i3</span>
</span><span class="line">  <span class="k">case</span> <span class="n">A</span>         <span class="c1">// =&gt; i3 0</span>
</span><span class="line">  <span class="k">case</span> <span class="n">B</span>         <span class="c1">// =&gt; i3 1</span>
</span><span class="line">  <span class="k">case</span> <span class="n">C</span>         <span class="c1">// =&gt; i3 2</span>
</span><span class="line">  <span class="k">case</span> <span class="n">D</span>         <span class="c1">// etc.</span>
</span><span class="line">  <span class="k">case</span> <span class="n">E</span>
</span><span class="line">  <span class="k">case</span> <span class="n">F</span>
</span><span class="line">  <span class="k">case</span> <span class="n">G</span>
</span><span class="line">  <span class="k">case</span> <span class="n">H</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<br />
辨别值之后，一个用于最后的case成为额外例子的枚举类型。
</p>

<h4>单一的对应枚举</h4>
<p>
如果枚举数据类型和一个或多个单情况没有数据的情况下(一个“单一的对应枚举”),然后与数据类型使用的数据类型来表示的二进制表示,必要时添加了零位标记。如果数据类型的二进制表示额外的条件,也就是说,有些模式类型的大小和对齐,但没有形成有效的值的类型,它们是用来表示没有数据的情况下,case的提升数值匹配的顺序没有数据情况下按声明顺序。如果类型有空闲位(见多个对应枚举),它们被用来形成额外的条件。然后枚举值表示为一个整数的存储大小的数据类型。额外的条件使用的负载类型不是枚举类型成为额外的条件enum类型本身。
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">enum</span> <span class="n">CharOrSectionMarker</span> <span class="p">{</span> <span class="o">=&gt;</span> <span class="n">LLVM</span> <span class="n">i32</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Paragraph</span>            <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0020</span><span class="n">_0000</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Char</span><span class="p">(</span><span class="n">UnicodeScalar</span><span class="p">)</span>  <span class="o">=&gt;</span> <span class="n">i32</span> <span class="p">(</span><span class="n">zext</span> <span class="n">i21</span> <span class="o">%</span><span class="n">Char</span> <span class="n">to</span> <span class="n">i32</span><span class="p">)</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Chapter</span>              <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0020</span><span class="n">_0001</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="n">CharOrSectionMarker</span><span class="p">.</span><span class="n">Char</span><span class="p">(</span><span class="sc">&#39;\x00&#39;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0000</span><span class="n">_0000</span>
</span><span class="line"><span class="n">CharOrSectionMarker</span><span class="p">.</span><span class="n">Char</span><span class="p">(</span><span class="err">&#39;\</span><span class="n">u10FFFF</span><span class="err">&#39;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0010</span><span class="n">_FFFF</span>
</span><span class="line">
</span><span class="line"><span class="k">enum</span> <span class="n">CharOrSectionMarkerOrFootnoteMarker</span> <span class="p">{</span> <span class="o">=&gt;</span> <span class="n">LLVM</span> <span class="n">i32</span>
</span><span class="line">  <span class="k">case</span> <span class="n">CharOrSectionMarker</span><span class="p">(</span><span class="n">CharOrSectionMarker</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">i32</span> <span class="o">%</span><span class="n">CharOrSectionMarker</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Asterisk</span>                                 <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0020</span><span class="n">_0002</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Dagger</span>                                   <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0020</span><span class="n">_0003</span>
</span><span class="line">  <span class="k">case</span> <span class="n">DoubleDagger</span>                             <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0020</span><span class="n">_0004</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<br />
如果数据类型没有额外的条件,或者没有足够的额外的条件表示没有数据的情况下,然后添加一个标记位enum的表示。没有数据的标记位设置情况下,然后分配数据区域中的值的枚举声明的顺序。
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">enum</span> <span class="n">IntOrInfinity</span> <span class="p">{</span> <span class="o">=&gt;</span> <span class="n">LLVM</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i1</span> <span class="p">}</span><span class="o">&gt;</span>
</span><span class="line">  <span class="k">case</span> <span class="n">NegInfinity</span>    <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i1</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span>    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">}</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Int</span><span class="p">(</span><span class="n">Int</span><span class="p">)</span>       <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i1</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span> <span class="o">%</span><span class="n">Int</span><span class="p">,</span> <span class="mi">0</span> <span class="p">}</span>
</span><span class="line">  <span class="k">case</span> <span class="n">PosInfinity</span>    <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i1</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span>    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="n">IntOrInfinity</span><span class="p">.</span><span class="n">Int</span><span class="p">(</span>    <span class="mi">0</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i1</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span>     <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">}</span>
</span><span class="line"><span class="n">IntOrInfinity</span><span class="p">.</span><span class="n">Int</span><span class="p">(</span><span class="mi">20721</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i1</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span> <span class="mi">20721</span><span class="p">,</span> <span class="mi">0</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</p>
<h4>多个对应枚举</h4>
<p>
如果一个枚举数据类型有多个情况,然后一个标签来区分数据类型是必要的。ABI首先会尝试找到共同闲置比特,即二进制数据类型的表示fixed-zero或忽略的有效值的所有数据类型。标签将被分散到这些闲置比特尽可能多。目前只备用的原始的整数类型,如高位被认为是<code>i21</code>类型。枚举数据表示为一个整数的存储大小的最大数据类型。
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">enum</span> <span class="n">TerminalChar</span> <span class="p">{</span>             <span class="o">=&gt;</span> <span class="n">LLVM</span> <span class="n">i32</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Plain</span><span class="p">(</span><span class="n">UnicodeScalar</span><span class="p">)</span>     <span class="o">=&gt;</span> <span class="n">i32</span>     <span class="p">(</span><span class="n">zext</span> <span class="n">i21</span> <span class="o">%</span><span class="n">Plain</span>     <span class="n">to</span> <span class="n">i32</span><span class="p">)</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Bold</span><span class="p">(</span><span class="n">UnicodeScalar</span><span class="p">)</span>      <span class="o">=&gt;</span> <span class="n">i32</span> <span class="p">(</span><span class="n">or</span> <span class="p">(</span><span class="n">zext</span> <span class="n">i21</span> <span class="o">%</span><span class="n">Bold</span>      <span class="n">to</span> <span class="n">i32</span><span class="p">),</span> <span class="mh">0x0020</span><span class="n">_0000</span><span class="p">)</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Underline</span><span class="p">(</span><span class="n">UnicodeScalar</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">i32</span> <span class="p">(</span><span class="n">or</span> <span class="p">(</span><span class="n">zext</span> <span class="n">i21</span> <span class="o">%</span><span class="n">Underline</span> <span class="n">to</span> <span class="n">i32</span><span class="p">),</span> <span class="mh">0x0040</span><span class="n">_0000</span><span class="p">)</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Blink</span><span class="p">(</span><span class="n">UnicodeScalar</span><span class="p">)</span>     <span class="o">=&gt;</span> <span class="n">i32</span> <span class="p">(</span><span class="n">or</span> <span class="p">(</span><span class="n">zext</span> <span class="n">i21</span> <span class="o">%</span><span class="n">Blink</span>     <span class="n">to</span> <span class="n">i32</span><span class="p">),</span> <span class="mh">0x0060</span><span class="n">_0000</span><span class="p">)</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Empty</span>                    <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0080</span><span class="n">_0000</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Cursor</span>                   <span class="o">=&gt;</span> <span class="n">i32</span> <span class="mh">0x0080</span><span class="n">_0001</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<br />
如果没有足够的空闲位包含标签,然后添加额外的比特表示包含标签。标签的值分配给数据情况下按声明顺序。如果有任何数据的情况下,他们被收集在一个共同的标签,并指定数据区域中的值的枚举声明的顺序。
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">class</span> <span class="n">Bignum</span> <span class="p">{}</span>
</span><span class="line">
</span><span class="line"><span class="k">enum</span> <span class="n">IntDoubleOrBignum</span> <span class="p">{</span> <span class="o">=&gt;</span> <span class="n">LLVM</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i2</span> <span class="p">}</span><span class="o">&gt;</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Int</span><span class="p">(</span><span class="n">Int</span><span class="p">)</span>           <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i2</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span>           <span class="o">%</span><span class="n">Int</span><span class="p">,</span>            <span class="mi">0</span> <span class="p">}</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Double</span><span class="p">(</span><span class="n">Double</span><span class="p">)</span>     <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i2</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span> <span class="p">(</span><span class="n">bitcast</span>  <span class="o">%</span><span class="n">Double</span> <span class="n">to</span> <span class="n">i64</span><span class="p">),</span> <span class="mi">1</span> <span class="p">}</span>
</span><span class="line">  <span class="k">case</span> <span class="n">Bignum</span><span class="p">(</span><span class="n">Bignum</span><span class="p">)</span>     <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="p">{</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i2</span> <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span> <span class="p">(</span><span class="n">ptrtoint</span> <span class="o">%</span><span class="n">Bignum</span> <span class="n">to</span> <span class="n">i64</span><span class="p">),</span> <span class="mi">2</span> <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</p>
<h2>存在容器的设计</h2>
<p>值的协议类型,协议组成类型,或“any”类型(<code>protocol&lt;&gt;</code>)提出使用存在容器(所谓的因为这些类型是类型理论中的“生存类型”)。</p>
<h4>存在的不透明容器</h4>
<p>如果没有类限制协议或协议组成类型,存在的容器必须适应值为任意大小和对齐。它使用一个固定大小的缓冲区,这是三个指针大小和pointer-aligned。这个直接包含的值,如果它的大小和对齐都小于或等于固定大小的缓冲区,或包含一个指针指向一个分配属于存在的容器。所包含的值的类型是由其类型标识元数据记录,为所有需要的协议和映射表的一致性。设计好像声明在C结构体如下:
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">struct</span> <span class="n">OpaqueExistentialContainer</span> <span class="p">{</span>
</span><span class="line">  <span class="kt">void</span> <span class="o">*</span><span class="n">fixedSizeBuffer</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span><span class="line">  <span class="n">Metadata</span> <span class="o">*</span><span class="n">type</span><span class="p">;</span>
</span><span class="line">  <span class="n">WitnessTable</span> <span class="o">*</span><span class="n">witnessTables</span><span class="p">[</span><span class="n">NUM_WITNESS_TABLES</span><span class="p">];</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</p>
<h4>存在的类的容器</h4>
<p>
如果一个或多个协议的协议或协议组成类型有一个类约束,然后只能存储在已经存在的容器,并使用一个更有效的表示。类实例总是一个指针的大小,所以不需要分配一个固定大小的缓冲区,和类实例总是有自己的引用类型的元数据,因此不需要单独的元数据记录。声明中的设计就好像下面C结构体:
<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">struct</span> <span class="n">ClassExistentialContainer</span> <span class="p">{</span>
</span><span class="line">  <span class="n">HeapObject</span> <span class="o">*</span><span class="n">value</span><span class="p">;</span>
</span><span class="line">  <span class="n">WitnessTable</span> <span class="o">*</span><span class="n">witnessTables</span><span class="p">[</span><span class="n">NUM_WITNESS_TABLES</span><span class="p">];</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<br />
注意,如果不需要映射表,如“任何类”类型的<code>protocol&lt;&gt;</code>或一个Objective-C协议类型,然后唯一元素设计堆对象的指针。这是ABI兼容的id,<code>Protocol</code>类型在Objective-C中。
</p>

<h2>元数据类型</h2>
<p>快速运行时保持元数据记录为每一类型在程序中使用,包括每一个实例化泛型类型的。可以使用这些元数据记录(TODO:映射)调试器工具发现的信息类型。对于非泛型名义类型,这些元数据是由编译器生成的静态记录。对泛型类型的实例,和内在类型如元组、功能、协议等等组成,元数据记录懒洋洋地根据需要运行时创建的。每个类型都有一个独特的元数据记录,两种元数据指针值相等,如果他们的类型相同。<br />
在下面的设计描述中,抵消了相对于元数据指针作为指针数组的索引。在32位平台上,抵消1意味着一个偏移量的4个字节,在64位平台上,这意味着8个字节的偏移量。<br />
</p>
<h4>通用元数据设计</h4>
<p>
所有元数据记录共享一个共同的数据头,下面字段:
<ul>
<li>映射价值表指针引用的vtable函数实现值的语义类型,提供了基本的操作,如分配,复制,销毁的类型。映射表也记录的值大小、对齐、步长等基本属性的类型。映射价值表指针偏移-1元数据的指针,即指针字节所在位置立即在指针的引用地址偏移。</li>
<li>类型字段是一个pointer-sized整数描述元数据描述。这个字段的偏移量为0的元数据的指针。</li>
</ul>
</p>
<h4>结构体元数据</h4>
<p>
除了常见的元数据字段设计、结构元数据记录包含以下字段:<br />
<ul>
<li>名义类型描述符引用偏移量1。</li>
<li>引用父元数据记录存储在偏移2。是一个封闭的名义类型的成员的结构,这是一个封闭类型的元数据的引用。对于高层结构体,这是null。（父指针总是空）</li>
<li>矢量偏移量从3开始。每个字段的结构体,在var声明顺序,字段的偏移字节从一开始的结构是存储为pointer-sized整数倍。</li>
<li>如果结构是通用的,那么通用参数向量始于抵消3 + n,其中n是结构中的字段的数量</li>
</ul>
</p>
<h4>枚举元数据</h4>
<p>除了常见的元数据字段设计,enum记录元数据包含以下字段:<br />
<ul>
<li>名义类型描述符引用偏移量1。</li>
<li>引用父元数据记录存储在偏移2。是一个封闭的名义类型的成员的结构,这是一个封闭类型的元数据的引用。对于高层结构体,这是null。（父指针总是空）</li>
<li>如果enum是通用的,那么通用参数向量始于偏移地址3。</li>
</ul>
</p>
<h4>元组元数据</h4>
<p>
除了常见的元数据字段设计、元组元数据记录包含以下字段:<br />
<ul>
<li>名义类型描述符引用偏移量1。</li>
<li>标签字符串指针连续以null结尾的标签名称的列表在元组偏移2。每个标签的名字是作为一个以null结尾,UTF-8编码的字符串序列。如果元组没有标签,这是一个空指针。(目前标签字符串指针总是空,独特的标签不考虑元组元数据)</li>
<li>向量的元素开始的偏移地址3,由一个向量type-offset对。第n个元素的元数据类型是指针的偏移地址3+2*n。字节的偏移量从一开始的第n个元素的元组开始的偏移量是3+2*n+1。</li>
</ul>
</p>
<h4>函数元数据</h4>
<p>除了常见的元数据字段设计,函数元数据记录包含以下字段:<br />
<ul>
<li>参数的数量函数存储在偏移量为1的地址。</li>
<li>结果的引用类型元数据记录存储在偏移量为2。如果函数有多个返回,这引用一个元组元数据记录</li>
<li>参数向量始于偏移地址3,由指针指向的函数的参数元数据记录。</li>
</ul>
<p>
如果函数需要任何in/out参数,每个参数的元数据记录指针将另外附加,一些被设置如果in/out最低位。由于指针对准,最低位持有这个标签总是空。
如果函数没有in/out参数,将只有一个指针在下列情形的向量:
</p>
<ul>
<li>0参数:一个元组元数据记录为空元组</li>
<li>1参数:第一个也是唯一一个参数的元数据记录</li>
<li>&gt; 1的参数:tuple包含参数的元数据记录</li>
</ul>
</p>
<h4>协议元数据</h4>
<p>
除了常见的元数据字段设计,协议元数据记录包含以下字段:</p>
<ul>
<li>设计标志词是储存在偏移为1。这个词的部分描述存在容器设计用于表示值的类型。这个词设计如下:<ul>
<li>映射表存储在最低位31位。协议类型的值包含这个数字映射表指针的设计。</li>
<li>类约束条件是储存在31位。这个位设置如果不类容器类型,这意味着结构、枚举、或类值中可以存储类型。如果没有设置,那么只能存储在类值类型,并使用一个更高效的设计类型。</li>
</ul>
注意字段pointer-sized,尽管只有最低的32位目前在所有平台上。这些值可以来自协议描述符记录,但预计算会更便利。
</li>
<li>协议的协议组成的数量是储存在偏移2。“任何”<code>protocol&lt;&gt; </code>。对于单一协议 <code>P</code>。协议构成类型<code>protocol&lt;P, Q, ...&gt;</code>,这是协议的数量</li>
<li>协议描述符向量始于偏移地址3。这是内联的协议描述符的指针数组中的每个协议组成,或单一协议为协议类型描述符。“任何”类型,没有协议描述符向量。</li>
</ul>

<h4>变型的元数据</h4>
<p>
除了常见的元数据字段设计、变型的元数据记录包含以下字段:
<ul>
<li>引用的实例类型的元数据记录变型代表是储存在偏移为1的地址。</li>
</ul>
</p>

<h4>类元数据</h4>
<p>
类元数据设计和Objective-C互操作;所有类元数据记录也有效的Objective-C类对象。类元数据指针的值被用作类变型,所以派生类的元数据记录也作为一个有效的为其父类的所有类变型价值。
<ul>
<li>析构函数指针存储在从元数据指针偏移2的地址，背后的价值关联表。此功能由Swift的析构器调用时的类实例被销毁<ul>
<li>isa指针指向Objective-C的兼容元类记录村春在偏移量是0的地址</li>
<li>父类指针指向元类数据记录的父类存储在偏移量1的地址，如果是根类，它为null</li>
<li>偏移2和偏移3保留用于Objective-C的运行时使用</li>
<li>该rodata指针存储在偏移4;它指向的类的Objective-C兼容rodata记录。该指针值包括标签。低位始终设置为1，Swift类和始终设置为0的Objective-C类。</li>
<li>类标志是一个32位字段偏移量5</li>
<li>实例地址指针是一个32位的字段后面的这个类的标志。此类指针实例的开始之后此字节数的实例指针。</li>
<li>实例大小是32位的字段后面的这个实例地址指针。这是存储本字节在这种类型的每一个对象的数</li>
<li>实例对准mask是一个16位的字段后面的这个实例的大小。这是一组低位，它们不能在一指针被设置为这个类的一个实例的。 </li>
<li>运行时保留字段是一个16位的字段后面的这个实例对齐mask。编译器初始化这个为零。 </li>
<li>类对象的大小是32位的字段，运行时保留字段之后。这是存储在类元数据对象的字节的总数。</li>
<li>对象的地址指针是一个32位的字段后面的这个类的对象的大小。这是存储在类元数据对象的字节数。 </li>
<li>名义类型描述为最派生类的类型被引用以立即偏移后的类对象的地址点。这是在64位的平台偏移8或在32位平台偏移11。 </li>
<li>对于每一个Swift类在类的继承层次结构，从根类订单开始一直到最派生类，以下领域都存在： </li>
<li>首先，参考到母体元数据记录被存储。对于类是一个封闭的名义类型的成员，这是一个引用封闭类型的元数据。对于顶级类，这是空。 </li>
<li>如果类是通用的，它的泛型参数向量的内联存储</li>
<li>V表被内嵌存储，并包含一个函数指针类的声明顺序的每一个方法的实现。 </li>
<li>如果一个类的实例的布局是依赖于它的通用参数，则字段偏置矢量存储直列，含有以字节偏移从实例指针类的每个字段中声明的顺序。 （对于类与固定布局，字段偏移都可以访问静态的全局变量，类似于Objective-C的ivar偏移。）</li>
</ul>

<p>请注意，这些字段都存在在继承层次的Objective-C基类。 </p>
<h4>通用参数向量</h4>
<p>元数据记录泛型类型的实例包含有关其泛型参数信息。对于类型的每个参数，引用为类型参数的元数据记录存储。在所有类型参数的元数据参考，对于每种类型的参数，如果有该类​​型参数的协议要求，引用的证人表中为每个协议，要求符合储存在声明顺序。 <br />
例如，给定一个泛型类型，在继承的参数&lt;T，U，V&gt;，它的泛型参数的记录将包括引用的元数据记录，T，U型和V，仿佛在C结构布局：<br />
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">struct</span> <span class="n">GenericParameterVector</span> <span class="p">{</span>
</span><span class="line">  <span class="n">TypeMetadata</span> <span class="o">*</span><span class="n">T</span><span class="p">,</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span> <span class="o">*</span><span class="n">V</span><span class="p">;</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
如果再加协议要求的参数，例如，<code> &lt;T: Runcible, U: protocol&lt;Fungible, Ansible&gt;, V&gt; </code>，那么该类型的泛型参数向量包含这些协议关联表，设计：
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="k">struct</span> <span class="n">GenericParameterVector</span> <span class="p">{</span>
</span><span class="line">  <span class="n">TypeMetadata</span> <span class="o">*</span><span class="n">T</span><span class="p">,</span> <span class="o">*</span><span class="n">U</span><span class="p">,</span> <span class="o">*</span><span class="n">V</span><span class="p">;</span>
</span><span class="line">  <span class="n">RuncibleWitnessTable</span> <span class="o">*</span><span class="n">T_Runcible</span><span class="p">;</span>
</span><span class="line">  <span class="n">FungibleWitnessTable</span> <span class="o">*</span><span class="n">U_Fungible</span><span class="p">;</span>
</span><span class="line">  <span class="n">AnsibleWitnessTable</span> <span class="o">*</span><span class="n">U_Ansible</span><span class="p">;</span>
</span><span class="line"><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</p>
<h4>通用类型描述符</h4>
<p>元数据记录类，结构和枚举类型包含一个指向类型描述符，其中包含有关名义类型的基本信息，如名称，成员和元数据的布局。对于泛型类型，一是名义类型描述符是该类型的所有实例共享。布局如下：
<ul>
<li>偏移0的存储类型<ul>
<li>若为0则是类</li>
<li>结构体为1</li>
<li>枚举是2</li>
</ul></li>
<li>错位的名称被引用为空值终止的C字符串量。本名称不包括绑定泛型参数。 </li>
<li>以下四个字段依赖于一种通用类型。 <ul>
<li>对一个类或者结构体来说:<ul>
<li>字段的数量被存储在偏移2。这是在元数据记录中的字段偏置向量的长度，如果有的话。 </li>
<li>的偏移到字段偏移矢量被存储在偏移3.这是中的偏移在元数据记录中的类型字段偏置向量的指针大小词语。如果没有字段偏置矢量被存储在元数据记录，这是零。 </li>
<li>字段名称偏移量4名的顺序对应的字段的领域偏移向量的顺序被引用为C字符串的双空结尾的列表。</li>
<li>该字段类型的访问是一个函数指针偏移5.如果非空，该函数需要一个指针类型的元数据标称类型的实例，并返回一个指针类型的元数据引用的字段类型的数组该实例。的顺序相匹配的领域偏移向量和字段名列表。 </li></ul></li>
<li>对一个枚举来说：<ul>
<li>的有效载荷的情况下和有效载荷大小偏移数被存储在偏移2的至少显著24位是有效载荷的情况下的数量，和在类型元数据的有效载荷大小的最显著8位的偏移，如果有的话。</li>
<li>没有效载荷的情况下的数量被存储在偏移3。 </li>
<li>case名称偏移量4名进行排序，从而有效载荷的情况下是第一位的，其次是无负载情况下被引用为C字符串的双空结尾的列表。在列表中的每个一半，名称的顺序对应于枚举声明的情况下的顺序。 </li>
<li>case类型的访问是一个函数指针偏移5.如果非空，该函数需要一个指针类型的元数据枚举的一个实例，并返回一个指针类型的元数据的引用为案件的类型数组该实例。的顺序相匹配的情况下，名单中。这个功能类似于字段类型存取器为一个结构，除了还结果中的每个元件的至少显著位如果枚举的情况下是一种间接的情况下设置的。 </li></ul></li>
</ul></li>
<li>如果名义类型是通用的，一个指针，在用于形成该类型的实例的元图形存储在偏移6.指针是空的，如果类型是不通用的。 </li>
<li>泛型参数描述开始于偏移7。这说明在元数据记录中的泛型参数向量的布局： <ul>
<li>通用参数向量的偏移存储在偏移7.这是中的偏移元数据记录内的通用参数向量的指针大小词语。如果该类型不是通用的，这是零。 </li>
<li>类型参数的数量存储在偏移8.这个计数包括相关类型的类型参数与协议约束。 </li>
<li>类型参数的数目被储存在仅偏移9.本计数包括初级形式类型参数。 </li>
<li>对于每个类型的参数n，以下字段中存储： <ul>
<li>该类型参数的数目存储在偏移10 + N。这是存储用于在通用参数向量类型参数表指针的数目。 </li></ul></li></ul></li>
</ul>
请注意，没有名义类型说明符的协议或协议类型。请参阅下面的协议描述符描述。
</p>
<h4>Protocol描述符</h4>
协议元数据包含描述所需的类型的协议值以符合引用零个，一个或多个协议的描述符。本协议描述的布局要与Objective-C的协议对象是兼容的。设计如下：
<ul>
<li>一个isa占位符存放在偏移0填充这个字段的Objective-C运行。 </li>
<li>错位的名称被引用为空值终止的C字符串偏移量1。 </li>
<li>如果协议继承的一个或多个其他协议，一个指针到继承的协议列表存储在偏移2.名单开始的继承协议作为一个指针大小整数的数目，和后跟许多协议描述符指针。如果协议继承了没有其他协议，这个指针为空。 </li>
<li>对于ObjC兼容协议，它需要的实例方法存储在偏移3作为ObjC兼容的方法列表。这是原生Swift协议无效。 </li>
<li>对于ObjC兼容协议，它需要的类方法都存储在偏移4作为ObjC兼容的方法列表。这是原生Swift协议无效。 </li>
<li>对于ObjC兼容协议，其可选实例方法存储在偏移5作为ObjC兼容的方法列表。这是原生Swift协议无效。 </li>
<li>对于ObjC兼容协议，其可选类的方法存储在偏移6作为ObjC兼容的方法列表。这是原生Swift协议无效。 </li>
<li>对于ObjC兼容协议，它的实例属性存储在偏移7作为ObjC兼容属性列表。这是原生Swift协议无效。 </li>
<li>该协议描述符记录的大小存储为一个32位整数偏移量8。这是目前72在64位的平台和40在32位的平台。</li>
<li>标志被存储为尺寸后的32位整数。以下位目前使用的（从最低计数显著零位）： <ul>
<li>位0是Swift位。坐落在Swift定义和取消的Objective-C中定义的协议所有协议。 </li>
<li>第1位是类约束一下。如果该协议不是类的限制，这意味着任何结构，枚举，或类类型可能符合协议设置它。它没有设置，如果只有类能遵守协议。 （该倒的意思是使用Objective-C协议的记录，在该位从未设置的兼容性。Objective-C的协议只能由类效法。） </li>
<li>第2位是映射表位。它设置，如果派遣协议的方法是通过映射表，可以是传递一个额外的参数，以通用的功能或包含在协议类型的存在容器设计完成。这是未设置如果调度是通过objc_msgSend完成，不需要额外的信息，陪符合类型的值。 </li>
<li>第31位是由Objective-C运行时设置它已经完成了它的初始化协议纪录。它是未使用的Swift运行。 </li>
</ul></li>
</ul>

<h2>重整</h2>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">mangled</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">_T</span><span class="err">&#39;</span> <span class="n">global</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
所有Swift-重整的名称以此前缀开头。
</p>
<h4>全局</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="sc">&#39;t&#39;</span> <span class="n">type</span>                    <span class="c1">// standalone type (for DWARF)</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="sc">&#39;M&#39;</span> <span class="n">type</span>                    <span class="c1">// type metadata (address point)</span>
</span><span class="line">                                       <span class="c1">// -- type starts with [BCOSTV]</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Mf</span><span class="err">&#39;</span> <span class="n">type</span>                   <span class="c1">// &#39;full&#39; type metadata (start of object)</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">MP</span><span class="err">&#39;</span> <span class="n">type</span>                   <span class="c1">// type metadata pattern</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Ma</span><span class="err">&#39;</span> <span class="n">type</span>                   <span class="c1">// type metadata access function</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">ML</span><span class="err">&#39;</span> <span class="n">type</span>                   <span class="c1">// type metadata lazy cache variable</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Mm</span><span class="err">&#39;</span> <span class="n">type</span>                   <span class="c1">// class metaclass</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Mn</span><span class="err">&#39;</span> <span class="n">nominal</span><span class="o">-</span><span class="n">type</span>           <span class="c1">// nominal type descriptor</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Mp</span><span class="err">&#39;</span> <span class="n">protocol</span>               <span class="c1">// protocol descriptor</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">PA</span><span class="err">&#39;</span> <span class="p">.</span><span class="o">*</span>                     <span class="c1">// partial application forwarder</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">PAo</span><span class="err">&#39;</span> <span class="p">.</span><span class="o">*</span>                    <span class="c1">// ObjC partial application forwarder</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="sc">&#39;w&#39;</span> <span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="n">type</span> <span class="c1">// value witness</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">WV</span><span class="err">&#39;</span> <span class="n">type</span>                   <span class="c1">// value witness table</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Wo</span><span class="err">&#39;</span> <span class="n">entity</span>                 <span class="c1">// witness table offset</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Wv</span><span class="err">&#39;</span> <span class="n">directness</span> <span class="n">entity</span>      <span class="c1">// field offset</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">WP</span><span class="err">&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span>   <span class="c1">// protocol witness table</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Wa</span><span class="err">&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span>   <span class="c1">// protocol witness table accessor</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Wl</span><span class="err">&#39;</span> <span class="n">type</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span> <span class="c1">// lazy protocol witness table accessor</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">WL</span><span class="err">&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span>   <span class="c1">// lazy protocol witness table cache variable</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">WD</span><span class="err">&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span>   <span class="c1">// dependent proto witness table generator</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Wd</span><span class="err">&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span>   <span class="c1">// dependent proto witness table template</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="n">entity</span>                      <span class="c1">// some identifiable thing</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">TO</span><span class="err">&#39;</span> <span class="n">global</span>                 <span class="c1">// ObjC-as-swift thunk</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">To</span><span class="err">&#39;</span> <span class="n">global</span>                 <span class="c1">// swift-as-ObjC thunk</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">TD</span><span class="err">&#39;</span> <span class="n">global</span>                 <span class="c1">// dynamic dispatch thunk</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Td</span><span class="err">&#39;</span> <span class="n">global</span>                 <span class="c1">// direct method reference thunk</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">TR</span><span class="err">&#39;</span> <span class="n">reabstract</span><span class="o">-</span><span class="n">signature</span>   <span class="c1">// reabstraction thunk helper function</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Tr</span><span class="err">&#39;</span> <span class="n">reabstract</span><span class="o">-</span><span class="n">signature</span>   <span class="c1">// reabstraction thunk</span>
</span><span class="line">
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">TS</span><span class="err">&#39;</span> <span class="n">specializationinfo</span> <span class="sc">&#39;_&#39;</span> <span class="n">mangled</span><span class="o">-</span><span class="n">name</span>
</span><span class="line"><span class="n">specializationinfo</span> <span class="o">::=</span> <span class="sc">&#39;g&#39;</span> <span class="n">passid</span> <span class="p">(</span><span class="n">type</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span><span class="o">*</span> <span class="sc">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span>            <span class="c1">// Generic specialization info.</span>
</span><span class="line"><span class="n">specializationinfo</span> <span class="o">::=</span> <span class="sc">&#39;f&#39;</span> <span class="n">passid</span> <span class="p">(</span><span class="n">funcspecializationarginfo</span> <span class="sc">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span>             <span class="c1">// Function signature specialization kind</span>
</span><span class="line"><span class="n">passid</span> <span class="o">::=</span> <span class="n">integer</span>                                                             <span class="c1">// The id of the pass that generated this specialization.</span>
</span><span class="line"><span class="n">funcsigspecializationarginfo</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">cl</span><span class="err">&#39;</span> <span class="n">closurename</span> <span class="n">type</span><span class="o">*</span>                        <span class="c1">// Closure specialized with closed over types in argument order.</span>
</span><span class="line"><span class="n">funcsigspecializationarginfo</span> <span class="o">::=</span> <span class="sc">&#39;n&#39;</span>                                           <span class="c1">// Unmodified argument</span>
</span><span class="line"><span class="n">funcsigspecializationarginfo</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">cp</span><span class="err">&#39;</span> <span class="n">funcsigspecializationconstantproppayload</span> <span class="c1">// Constant propagated argument</span>
</span><span class="line"><span class="n">funcsigspecializationarginfo</span> <span class="o">::=</span> <span class="sc">&#39;d&#39;</span>                                           <span class="c1">// Dead argument</span>
</span><span class="line"><span class="n">funcsigspecializationarginfo</span> <span class="o">::=</span> <span class="sc">&#39;g&#39;</span> <span class="sc">&#39;s&#39;</span><span class="o">?</span>                                      <span class="c1">// Owned =&gt; Guaranteed and Exploded if &#39;s&#39; present.</span>
</span><span class="line"><span class="n">funcsigspecializationarginfo</span> <span class="o">::=</span> <span class="sc">&#39;s&#39;</span>                                           <span class="c1">// Exploded</span>
</span><span class="line"><span class="n">funcsigspecializationarginfo</span> <span class="o">::=</span> <span class="sc">&#39;k&#39;</span>                                           <span class="c1">// Exploded</span>
</span><span class="line"><span class="n">funcsigspecializationconstantpropinfo</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">fr</span><span class="err">&#39;</span> <span class="n">mangled</span><span class="o">-</span><span class="n">name</span>
</span><span class="line"><span class="n">funcsigspecializationconstantpropinfo</span> <span class="o">::=</span> <span class="sc">&#39;g&#39;</span> <span class="n">mangled</span><span class="o">-</span><span class="n">name</span>
</span><span class="line"><span class="n">funcsigspecializationconstantpropinfo</span> <span class="o">::=</span> <span class="sc">&#39;i&#39;</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="o">-</span><span class="n">integer</span>
</span><span class="line"><span class="n">funcsigspecializationconstantpropinfo</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">fl</span><span class="err">&#39;</span> <span class="kt">float</span><span class="o">-</span><span class="n">as</span><span class="o">-</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="o">-</span><span class="n">integer</span>
</span><span class="line"><span class="n">funcsigspecializationconstantpropinfo</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">se</span><span class="err">&#39;</span> <span class="n">stringencoding</span> <span class="sc">&#39;v&#39;</span> <span class="n">md5hash</span>
</span><span class="line">
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">TV</span><span class="err">&#39;</span> <span class="n">global</span>                 <span class="c1">// vtable override thunk</span>
</span><span class="line"><span class="n">global</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">TW</span><span class="err">&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span> <span class="n">entity</span>
</span><span class="line">                                       <span class="c1">// protocol witness thunk</span>
</span><span class="line"><span class="n">entity</span> <span class="o">::=</span> <span class="n">nominal</span><span class="o">-</span><span class="n">type</span>                <span class="c1">// named type declaration</span>
</span><span class="line"><span class="n">entity</span> <span class="o">::=</span> <span class="k">static</span><span class="o">?</span> <span class="n">entity</span><span class="o">-</span><span class="n">kind</span> <span class="n">context</span> <span class="n">entity</span><span class="o">-</span><span class="n">name</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;F&#39;</span>                    <span class="c1">// function (ctor, accessor, etc.)</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;v&#39;</span>                    <span class="c1">// variable (let/var)</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;i&#39;</span>                    <span class="c1">// subscript (&#39;i&#39;ndex) itself (not the individual accessors)</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;I&#39;</span>                    <span class="c1">// initializer</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>         <span class="c1">// named declaration</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;A&#39;</span> <span class="n">index</span>              <span class="c1">// default argument generator</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;a&#39;</span> <span class="n">addressor</span><span class="o">-</span><span class="n">kind</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>     <span class="c1">// mutable addressor</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;C&#39;</span> <span class="n">type</span>               <span class="c1">// allocating constructor</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;c&#39;</span> <span class="n">type</span>               <span class="c1">// non-allocating constructor</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;D&#39;</span>                    <span class="c1">// deallocating destructor; untyped</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;d&#39;</span>                    <span class="c1">// non-deallocating destructor; untyped</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;g&#39;</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>     <span class="c1">// getter</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;i&#39;</span>                    <span class="c1">// non-local variable initializer</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;l&#39;</span> <span class="n">addressor</span><span class="o">-</span><span class="n">kind</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>     <span class="c1">// non-mutable addressor</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;m&#39;</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>     <span class="c1">// materializeForSet</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;s&#39;</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>     <span class="c1">// setter</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;U&#39;</span> <span class="n">index</span> <span class="n">type</span>         <span class="c1">// explicit anonymous closure expression</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;u&#39;</span> <span class="n">index</span> <span class="n">type</span>         <span class="c1">// implicit anonymous closure</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;w&#39;</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>     <span class="c1">// willSet</span>
</span><span class="line"><span class="n">entity</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;W&#39;</span> <span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="n">type</span>     <span class="c1">// didSet</span>
</span><span class="line"><span class="k">static</span> <span class="o">::=</span> <span class="sc">&#39;Z&#39;</span>                         <span class="c1">// entity is a static member of a type</span>
</span><span class="line"><span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="n">identifier</span>
</span><span class="line"><span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="n">local</span><span class="o">-</span><span class="n">decl</span><span class="o">-</span><span class="n">name</span>
</span><span class="line"><span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="n">private</span><span class="o">-</span><span class="n">decl</span><span class="o">-</span><span class="n">name</span>
</span><span class="line"><span class="n">local</span><span class="o">-</span><span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;L&#39;</span> <span class="n">index</span> <span class="n">identifier</span>  <span class="c1">// locally-discriminated declaration</span>
</span><span class="line"><span class="n">private</span><span class="o">-</span><span class="n">decl</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="sc">&#39;P&#39;</span> <span class="n">identifier</span> <span class="n">identifier</span>  <span class="c1">// file-discriminated declaration</span>
</span><span class="line"><span class="n">reabstract</span><span class="o">-</span><span class="n">signature</span> <span class="o">::=</span> <span class="p">(</span><span class="sc">&#39;G&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">signature</span><span class="p">)</span><span class="o">?</span> <span class="n">type</span> <span class="n">type</span>
</span><span class="line"><span class="n">addressor</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;u&#39;</span>                 <span class="c1">// unsafe addressor (no owner)</span>
</span><span class="line"><span class="n">addressor</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;O&#39;</span>                 <span class="c1">// owning addressor (non-native owner)</span>
</span><span class="line"><span class="n">addressor</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;o&#39;</span>                 <span class="c1">// owning addressor (native owner)</span>
</span><span class="line"><span class="n">addressor</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;p&#39;</span>                 <span class="c1">// pinning addressor (native owner)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
实体开始于<code>entity</code> <code>nominal-type-kind ([COPV])</code>,去取代 <code>([Ss])</code> <code> entity-kind ([FIiv])</code>。
<code>entity-name</code>开头<code>[AaCcDggis]</code>或<code>decl-name</code>。一个<code>decl-name</code>开头<code>[LP]</code>或标识符<code>（[0-9oX]）</code>。
一个上下文开始于任一实体，一个扩展（其开头[EE]），或者一个模块，它可能是一个标识符（[0-9oX]）或模块的取代（[SS]）。
全局的修正开始于<code>[MTWw]</code>。
如果部分应用程序转发器是一个静态符号，它的名字将开始与序列_TPA_随后转发的目的地的错位符号名称。
一个普通的专业化的mangling由一个头，指定用于专门的泛型函数的类型和不合格，其次是原来的非专业化的通用符号的全面重整名称。
在一<private-decl-name>中的第一标识符是表示原始声明来自文件的字符串。应考虑的包围模块内是唯一的。第二标识符是实体的名称。
并非所有的声明标志着民营声明中，将使用<private-decl-name>压延;如果实体的上下文是足以唯一标识该实体中，简单的标识符形式是优选的。
在<reabstract-signature>的类型始终是非多态<实现了一套功能型>类型。

<h4>直接和间接的符号</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">directness</span> <span class="o">::=</span> <span class="sc">&#39;d&#39;</span>                         <span class="c1">// direct</span>
</span><span class="line"><span class="n">directness</span> <span class="o">::=</span> <span class="sc">&#39;i&#39;</span>                         <span class="c1">// indirect</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
直接符号解析直接对象的地址。间接符号解析为一个指向对象的地址。他们是不同的manglings做某一类的错误显而易见。

讨论补偿时的术语稍微超载。直接抵消解析为一个变量持有真正的偏移。间接偏移解析为一个变量保持的偏移被应用到输入的元数据，以获得真实的地址偏移。 （偏移量是必需的变量时，被一个弹性的结构，当物体的布局可能依赖于通用的参数中访问谎言的对象，这些偏移量必须保持在元数据中，间接磁场偏移访问泛型类型的字段时，因此，需要地方元数据本身具有未知的布局。）
</p>
<h4>声明上下文</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">context</span> <span class="o">::=</span> <span class="n">module</span>
</span><span class="line"><span class="n">context</span> <span class="o">::=</span> <span class="n">extension</span>
</span><span class="line"><span class="n">context</span> <span class="o">::=</span> <span class="n">entity</span>
</span><span class="line"><span class="n">module</span> <span class="o">::=</span> <span class="n">substitution</span>                    <span class="c1">// other substitution</span>
</span><span class="line"><span class="n">module</span> <span class="o">::=</span> <span class="n">identifier</span>                      <span class="c1">// module name</span>
</span><span class="line"><span class="n">module</span> <span class="o">::=</span> <span class="n">known</span><span class="o">-</span><span class="n">module</span>                    <span class="c1">// abbreviation</span>
</span><span class="line"><span class="n">extension</span> <span class="o">::=</span> <span class="sc">&#39;E&#39;</span> <span class="n">module</span> <span class="n">entity</span>
</span><span class="line"><span class="n">extension</span> <span class="o">::=</span> <span class="sc">&#39;e&#39;</span> <span class="n">module</span> <span class="n">generic</span><span class="o">-</span><span class="n">signature</span> <span class="n">entity</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
这些manglings确定封闭的上下文中，一个实体被声明，如它的封闭模块，功​​能，或名义类型。
一个扩展的mangling时则使用一个实体的声明上下文是一个扩展和被扩展的实体是在不同的模块。在这种情况下，扩展的模块第一错位，随后由实体被扩展。如果延伸和扩展的实体都在同一模块中，普通实体重整是首选。如果扩展受到限制，在延长的限制被损毁，其一般签名。
当重整本地实体的一个构造或析构，该非分配或非重新分配的方式用于内的上下文。
</p>
<h4>类型</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Bb</span><span class="err">&#39;</span>                              <span class="c1">// Builtin.BridgeObject</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">BB</span><span class="err">&#39;</span>                              <span class="c1">// Builtin.UnsafeValueBuffer</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Bf</span><span class="err">&#39;</span> <span class="n">natural</span> <span class="sc">&#39;_&#39;</span>                  <span class="c1">// Builtin.Float&lt;n&gt;</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Bi</span><span class="err">&#39;</span> <span class="n">natural</span> <span class="sc">&#39;_&#39;</span>                  <span class="c1">// Builtin.Int&lt;n&gt;</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">BO</span><span class="err">&#39;</span>                              <span class="c1">// Builtin.ObjCPointer</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Bo</span><span class="err">&#39;</span>                              <span class="c1">// Builtin.ObjectPointer</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Bp</span><span class="err">&#39;</span>                              <span class="c1">// Builtin.RawPointer</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Bv</span><span class="err">&#39;</span> <span class="n">natural</span> <span class="n">type</span>                 <span class="c1">// Builtin.Vec&lt;n&gt;x&lt;type&gt;</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Bw</span><span class="err">&#39;</span>                              <span class="c1">// Builtin.Word</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="n">nominal</span><span class="o">-</span><span class="n">type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="n">associated</span><span class="o">-</span><span class="n">type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;a&#39;</span> <span class="n">context</span> <span class="n">identifier</span>            <span class="c1">// Type alias (DWARF only)</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;b&#39;</span> <span class="n">type</span> <span class="n">type</span>                     <span class="c1">// objc block function type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;c&#39;</span> <span class="n">type</span> <span class="n">type</span>                     <span class="c1">// C function pointer type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;F&#39;</span> <span class="n">throws</span><span class="o">-</span><span class="n">annotation</span><span class="o">?</span> <span class="n">type</span> <span class="n">type</span>  <span class="c1">// function type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;f&#39;</span> <span class="n">throws</span><span class="o">-</span><span class="n">annotation</span><span class="o">?</span> <span class="n">type</span> <span class="n">type</span>  <span class="c1">// uncurried function type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;G&#39;</span> <span class="n">type</span> <span class="o">&lt;</span><span class="n">type</span><span class="o">&gt;+</span> <span class="sc">&#39;_&#39;</span>              <span class="c1">// generic type application</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;K&#39;</span> <span class="n">type</span> <span class="n">type</span>                     <span class="c1">// @auto_closure function type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;M&#39;</span> <span class="n">type</span>                          <span class="c1">// metatype without representation</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">XM</span><span class="err">&#39;</span> <span class="n">metatype</span><span class="o">-</span><span class="n">repr</span> <span class="n">type</span>           <span class="c1">// metatype with representation</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;P&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">list</span> <span class="sc">&#39;_&#39;</span>             <span class="c1">// protocol type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">PM</span><span class="err">&#39;</span> <span class="n">type</span>                         <span class="c1">// existential metatype without representation</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">XPM</span><span class="err">&#39;</span> <span class="n">metatype</span><span class="o">-</span><span class="n">repr</span> <span class="n">type</span>          <span class="c1">// existential metatype with representation</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="n">archetype</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;R&#39;</span> <span class="n">type</span>                          <span class="c1">// inout</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;T&#39;</span> <span class="n">tuple</span><span class="o">-</span><span class="n">element</span><span class="o">*</span> <span class="sc">&#39;_&#39;</span>            <span class="c1">// tuple</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;t&#39;</span> <span class="n">tuple</span><span class="o">-</span><span class="n">element</span><span class="o">*</span> <span class="sc">&#39;_&#39;</span>            <span class="c1">// variadic tuple</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Xo</span><span class="err">&#39;</span> <span class="n">type</span>                         <span class="c1">// @unowned type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Xu</span><span class="err">&#39;</span> <span class="n">type</span>                         <span class="c1">// @unowned(unsafe) type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Xw</span><span class="err">&#39;</span> <span class="n">type</span>                         <span class="c1">// @weak type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">XF</span><span class="err">&#39;</span> <span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">type</span>           <span class="c1">// function implementation type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Xf</span><span class="err">&#39;</span> <span class="n">type</span> <span class="n">type</span>                    <span class="c1">// @thin function type</span>
</span><span class="line"><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span>
</span><span class="line"><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="n">substitution</span>
</span><span class="line"><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="n">nominal</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">kind</span> <span class="n">declaration</span><span class="o">-</span><span class="n">name</span>
</span><span class="line"><span class="n">nominal</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;C&#39;</span>                  <span class="c1">// class</span>
</span><span class="line"><span class="n">nominal</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;O&#39;</span>                  <span class="c1">// enum</span>
</span><span class="line"><span class="n">nominal</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="sc">&#39;V&#39;</span>                  <span class="c1">// struct</span>
</span><span class="line"><span class="n">archetype</span> <span class="o">::=</span> <span class="sc">&#39;Q&#39;</span> <span class="n">index</span>                    <span class="c1">// archetype with depth=0, idx=N</span>
</span><span class="line"><span class="n">archetype</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Qd</span><span class="err">&#39;</span> <span class="n">index</span> <span class="n">index</span>             <span class="c1">// archetype with depth=M+1, idx=N</span>
</span><span class="line"><span class="n">archetype</span> <span class="o">::=</span> <span class="n">associated</span><span class="o">-</span><span class="n">type</span>
</span><span class="line"><span class="n">archetype</span> <span class="o">::=</span> <span class="n">qualified</span><span class="o">-</span><span class="n">archetype</span>
</span><span class="line"><span class="n">associated</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="n">substitution</span>
</span><span class="line"><span class="n">associated</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;Q&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">context</span>     <span class="c1">// self type of protocol</span>
</span><span class="line"><span class="n">associated</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;Q&#39;</span> <span class="n">archetype</span> <span class="n">identifier</span> <span class="c1">// associated type</span>
</span><span class="line"><span class="n">qualified</span><span class="o">-</span><span class="n">archetype</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Qq</span><span class="err">&#39;</span> <span class="n">index</span> <span class="n">context</span>   <span class="c1">// archetype+context (DWARF only)</span>
</span><span class="line"><span class="n">protocol</span><span class="o">-</span><span class="n">context</span> <span class="o">::=</span> <span class="sc">&#39;P&#39;</span> <span class="n">protocol</span>
</span><span class="line"><span class="n">tuple</span><span class="o">-</span><span class="n">element</span> <span class="o">::=</span> <span class="n">identifier</span><span class="o">?</span> <span class="n">type</span>
</span><span class="line"><span class="n">metatype</span><span class="o">-</span><span class="n">repr</span> <span class="o">::=</span> <span class="sc">&#39;t&#39;</span>                      <span class="c1">// Thin metatype representation</span>
</span><span class="line"><span class="n">metatype</span><span class="o">-</span><span class="n">repr</span> <span class="o">::=</span> <span class="sc">&#39;T&#39;</span>                      <span class="c1">// Thick metatype representation</span>
</span><span class="line"><span class="n">metatype</span><span class="o">-</span><span class="n">repr</span> <span class="o">::=</span> <span class="sc">&#39;o&#39;</span>                      <span class="c1">// ObjC metatype representation</span>
</span><span class="line"><span class="n">throws</span><span class="o">-</span><span class="n">annotation</span> <span class="o">::=</span> <span class="sc">&#39;z&#39;</span>                  <span class="c1">// &#39;throws&#39; annotation on function types</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;u&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">signature</span> <span class="n">type</span>        <span class="c1">// generic type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;x&#39;</span>                               <span class="c1">// generic param, depth=0, idx=0</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;q&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span>           <span class="c1">// dependent generic parameter</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;q&#39;</span> <span class="n">type</span> <span class="n">assoc</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">name</span>          <span class="c1">// associated type of non-generic param</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;w&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span> <span class="n">assoc</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">name</span> <span class="c1">// associated type</span>
</span><span class="line"><span class="n">type</span> <span class="o">::=</span> <span class="sc">&#39;W&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span> <span class="n">assoc</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">name</span><span class="o">+</span> <span class="sc">&#39;_&#39;</span> <span class="c1">// associated type at depth</span>
</span><span class="line">
</span><span class="line"><span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span> <span class="o">::=</span> <span class="sc">&#39;x&#39;</span>                <span class="c1">// depth = 0,   idx = 0</span>
</span><span class="line"><span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span> <span class="o">::=</span> <span class="n">index</span>              <span class="c1">// depth = 0,   idx = N+1</span>
</span><span class="line"><span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span> <span class="o">::=</span> <span class="sc">&#39;d&#39;</span> <span class="n">index</span> <span class="n">index</span>    <span class="c1">// depth = M+1, idx = N</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<type>从未开始或以数字结束。 <type>从不以下划线开头。 <type>从来没有开始与D。 <type>从来没有开始以Z。

请注意，协议裂伤不同的类型和作为背景。一个协议方面总是由一个单一的协议名称等等轧液没有一个结尾下划线。协议类型可以有并列设置，结束于结尾下划线零个，一个或多个协议的范围。
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">assoc</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="p">(</span><span class="sc">&#39;P&#39;</span> <span class="n">protocol</span><span class="o">-</span><span class="n">name</span><span class="p">)</span><span class="o">?</span> <span class="n">identifier</span>
</span><span class="line"><span class="n">assoc</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">name</span> <span class="o">::=</span> <span class="n">substitution</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
相关类型因此使用缩写的mangling当基座通用参数或关联式是由一个单一的规约要求的限制。在这种情况下，相关联的类型可以明确引用的名字单独。如果基有多个符合性限制，那么协议名称是错位的消除歧义。
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span>
</span><span class="line">  <span class="n">impl</span><span class="o">-</span><span class="n">callee</span><span class="o">-</span><span class="n">convention</span> <span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span><span class="o">*</span> <span class="n">generic</span><span class="o">-</span><span class="n">signature</span><span class="o">?</span> <span class="sc">&#39;_&#39;</span>
</span><span class="line">  <span class="n">impl</span><span class="o">-</span><span class="n">parameter</span><span class="o">*</span> <span class="sc">&#39;_&#39;</span> <span class="n">impl</span><span class="o">-</span><span class="n">result</span><span class="o">*</span> <span class="sc">&#39;_&#39;</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">callee</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;t&#39;</span>              <span class="c1">// thin</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">callee</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="n">impl</span><span class="o">-</span><span class="n">convention</span>  <span class="c1">// thick, callee transferred with given convention</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;a&#39;</span>                     <span class="c1">// direct, autoreleased</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;d&#39;</span>                     <span class="c1">// direct, no ownership transfer</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;D&#39;</span>                     <span class="c1">// direct, no ownership transfer,</span>
</span><span class="line">                                            <span class="c1">// dependent on &#39;self&#39; parameter</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;g&#39;</span>                     <span class="c1">// direct, guaranteed</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;e&#39;</span>                     <span class="c1">// direct, deallocating</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;i&#39;</span>                     <span class="c1">// indirect, ownership transfer</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;l&#39;</span>                     <span class="c1">// indirect, inout</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;G&#39;</span>                     <span class="c1">// indirect, guaranteed</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;o&#39;</span>                     <span class="c1">// direct, ownership transfer</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="o">::=</span> <span class="sc">&#39;z&#39;</span> <span class="n">impl</span><span class="o">-</span><span class="n">convention</span>     <span class="c1">// error result</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Cb</span><span class="err">&#39;</span>            <span class="c1">// compatible with C block invocation function</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Cc</span><span class="err">&#39;</span>            <span class="c1">// compatible with C global function</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Cm</span><span class="err">&#39;</span>            <span class="c1">// compatible with Swift method</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">CO</span><span class="err">&#39;</span>            <span class="c1">// compatible with ObjC method</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Cw</span><span class="err">&#39;</span>            <span class="c1">// compatible with protocol witness</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span> <span class="o">::=</span> <span class="sc">&#39;N&#39;</span>             <span class="c1">// noreturn</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">function</span><span class="o">-</span><span class="n">attribute</span> <span class="o">::=</span> <span class="sc">&#39;G&#39;</span>             <span class="c1">// generic</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">parameter</span> <span class="o">::=</span> <span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="n">type</span>
</span><span class="line"><span class="n">impl</span><span class="o">-</span><span class="n">result</span> <span class="o">::=</span> <span class="n">impl</span><span class="o">-</span><span class="n">convention</span> <span class="n">type</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
在大多数情况下，manglings遵循的正式语言类型的结构。然而，在某些情况下，它是更为有用的函数类型的准确实现细节进行编码。
任何<impl-function-attribute>产品必须出现在它们上面指定的顺序：例如：一个不返回的C函数的错位与CCN。
需要注意的是，公约和功能属性的制作并不需要从一个<type>的开始消除歧义。

<h4>泛型</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">protocol</span><span class="o">-</span><span class="n">conformance</span> <span class="o">::=</span> <span class="p">(</span><span class="sc">&#39;u&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">signature</span><span class="p">)</span><span class="o">?</span> <span class="n">type</span> <span class="n">protocol</span> <span class="n">module</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<protocol-conformance>是指一个类型的一致性协议。命名模块包含声明的一致性扩展或类型声明之一。
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">generic</span><span class="o">-</span><span class="n">signature</span> <span class="o">::=</span> <span class="p">(</span><span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">count</span><span class="o">+</span><span class="p">)</span><span class="o">?</span> <span class="p">(</span><span class="sc">&#39;R&#39;</span> <span class="n">requirement</span><span class="o">*</span><span class="p">)</span><span class="o">?</span> <span class="sc">&#39;r&#39;</span>
</span><span class="line"><span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">count</span> <span class="o">::=</span> <span class="sc">&#39;z&#39;</span>       <span class="c1">// zero parameters</span>
</span><span class="line"><span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">count</span> <span class="o">::=</span> <span class="n">index</span>     <span class="c1">// N+1 parameters</span>
</span><span class="line"><span class="n">requirement</span> <span class="o">::=</span> <span class="n">type</span><span class="o">-</span><span class="n">param</span> <span class="n">protocol</span><span class="o">-</span><span class="n">name</span> <span class="c1">// protocol requirement</span>
</span><span class="line"><span class="n">requirement</span> <span class="o">::=</span> <span class="n">type</span><span class="o">-</span><span class="n">param</span> <span class="n">type</span>          <span class="c1">// base class requirement</span>
</span><span class="line">                                         <span class="c1">// type starts with [CS]</span>
</span><span class="line"><span class="n">requirement</span> <span class="o">::=</span> <span class="n">type</span><span class="o">-</span><span class="n">param</span> <span class="sc">&#39;z&#39;</span> <span class="n">type</span>      <span class="c1">// &#39;z&#39;ame-type requirement</span>
</span><span class="line">
</span><span class="line"><span class="c1">// Special type mangling for type params that saves the initial &#39;q&#39; on</span>
</span><span class="line"><span class="c1">// generic params</span>
</span><span class="line"><span class="n">type</span><span class="o">-</span><span class="n">param</span> <span class="o">::=</span> <span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span>       <span class="c1">// generic parameter</span>
</span><span class="line"><span class="n">type</span><span class="o">-</span><span class="n">param</span> <span class="o">::=</span> <span class="sc">&#39;w&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span> <span class="n">assoc</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">name</span> <span class="c1">// associated type</span>
</span><span class="line"><span class="n">type</span><span class="o">-</span><span class="n">param</span> <span class="o">::=</span> <span class="sc">&#39;W&#39;</span> <span class="n">generic</span><span class="o">-</span><span class="n">param</span><span class="o">-</span><span class="n">index</span> <span class="n">assoc</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">name</span><span class="o">+</span> <span class="sc">&#39;_&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
一个通用的签名首先描述在每个深度的签名，随后要求的通用参数的数量。作为一个特殊的情况下，没有generic-param-count表示在最外深度单个通用参数：
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">urFq_q_</span>                           <span class="c1">// &lt;T_0_0&gt; T_0_0 -&gt; T_0_0</span>
</span><span class="line"><span class="n">u_0_rFq_qd_0_</span>                     <span class="c1">// &lt;T_0_0&gt;&lt;T_1_0, T_1_1&gt; T_0_0 -&gt; T_1_1</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<h4>映射值</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">al</span><span class="err">&#39;</span>           <span class="c1">// allocateBuffer</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">ca</span><span class="err">&#39;</span>           <span class="c1">// assignWithCopy</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">ta</span><span class="err">&#39;</span>           <span class="c1">// assignWithTake</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">de</span><span class="err">&#39;</span>           <span class="c1">// deallocateBuffer</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">xx</span><span class="err">&#39;</span>           <span class="c1">// destroy</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">XX</span><span class="err">&#39;</span>           <span class="c1">// destroyBuffer</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Xx</span><span class="err">&#39;</span>           <span class="c1">// destroyArray</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">CP</span><span class="err">&#39;</span>           <span class="c1">// initializeBufferWithCopyOfBuffer</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Cp</span><span class="err">&#39;</span>           <span class="c1">// initializeBufferWithCopy</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">cp</span><span class="err">&#39;</span>           <span class="c1">// initializeWithCopy</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">TK</span><span class="err">&#39;</span>           <span class="c1">// initializeBufferWithTakeOfBuffer</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Tk</span><span class="err">&#39;</span>           <span class="c1">// initializeBufferWithTake</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">tk</span><span class="err">&#39;</span>           <span class="c1">// initializeWithTake</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">pr</span><span class="err">&#39;</span>           <span class="c1">// projectBuffer</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">xs</span><span class="err">&#39;</span>           <span class="c1">// storeExtraInhabitant</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">xg</span><span class="err">&#39;</span>           <span class="c1">// getExtraInhabitantIndex</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Cc</span><span class="err">&#39;</span>           <span class="c1">// initializeArrayWithCopy</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Tt</span><span class="err">&#39;</span>           <span class="c1">// initializeArrayWithTakeFrontToBack</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">tT</span><span class="err">&#39;</span>           <span class="c1">// initializeArrayWithTakeBackToFront</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">ug</span><span class="err">&#39;</span>           <span class="c1">// getEnumTag</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">up</span><span class="err">&#39;</span>           <span class="c1">// destructiveProjectEnumData</span>
</span><span class="line"><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">ui</span><span class="err">&#39;</span>           <span class="c1">// destructiveInjectEnumTag</span>
</span><span class="line"><span class="o">&lt;</span><span class="n">value</span><span class="o">-</span><span class="n">witness</span><span class="o">-</span><span class="n">kind</span><span class="o">&gt;</span> <span class="n">differentiates</span> <span class="n">the</span> <span class="n">kinds</span> <span class="n">of</span> <span class="n">value</span> <span class="n">witness</span> <span class="n">functions</span> <span class="k">for</span> <span class="n">a</span> <span class="n">type</span><span class="p">.</span>
</span><span class="line">
</span><span class="line"><span class="n">Identifiers</span>
</span><span class="line">
</span><span class="line"><span class="n">identifier</span> <span class="o">::=</span> <span class="n">natural</span> <span class="n">identifier</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="kt">char</span> <span class="n">identifier</span><span class="o">-</span><span class="kt">char</span><span class="o">*</span>
</span><span class="line"><span class="n">identifier</span> <span class="o">::=</span> <span class="sc">&#39;o&#39;</span> <span class="n">operator</span><span class="o">-</span><span class="n">fixity</span> <span class="n">natural</span> <span class="n">operator</span><span class="o">-</span><span class="kt">char</span><span class="o">+</span>
</span><span class="line">
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="n">fixity</span> <span class="o">::=</span> <span class="sc">&#39;p&#39;</span>                    <span class="c1">// prefix operator</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="n">fixity</span> <span class="o">::=</span> <span class="sc">&#39;P&#39;</span>                    <span class="c1">// postfix operator</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="n">fixity</span> <span class="o">::=</span> <span class="sc">&#39;i&#39;</span>                    <span class="c1">// infix operator</span>
</span><span class="line">
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;a&#39;</span>                      <span class="c1">// &amp; &#39;and&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;c&#39;</span>                      <span class="c1">// @ &#39;commercial at&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;d&#39;</span>                      <span class="c1">// / &#39;divide&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;e&#39;</span>                      <span class="c1">// = &#39;equals&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;g&#39;</span>                      <span class="c1">// &gt; &#39;greater&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;l&#39;</span>                      <span class="c1">// &lt; &#39;less&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;m&#39;</span>                      <span class="c1">// * &#39;multiply&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;n&#39;</span>                      <span class="c1">// ! &#39;not&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;o&#39;</span>                      <span class="c1">// | &#39;or&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;p&#39;</span>                      <span class="c1">// + &#39;plus&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;q&#39;</span>                      <span class="c1">// ? &#39;question&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;r&#39;</span>                      <span class="c1">// % &#39;remainder&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;s&#39;</span>                      <span class="c1">// - &#39;subtract&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;t&#39;</span>                      <span class="c1">// ~ &#39;tilde&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;x&#39;</span>                      <span class="c1">// ^ &#39;xor&#39;</span>
</span><span class="line"><span class="n">operator</span><span class="o">-</span><span class="kt">char</span> <span class="o">::=</span> <span class="sc">&#39;z&#39;</span>                      <span class="c1">// . &#39;zperiod&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<identifier>是运行长度编码：自然表示的字符如何跟进。操作字符映射到字母字符给出。在两种情况下可以一个标识符以数字开头，所以有与运行长度没有歧义。
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">identifier</span> <span class="o">::=</span> <span class="sc">&#39;X&#39;</span> <span class="n">natural</span> <span class="n">identifier</span><span class="o">-</span><span class="n">start</span><span class="o">-</span><span class="kt">char</span> <span class="n">identifier</span><span class="o">-</span><span class="kt">char</span><span class="o">*</span>
</span><span class="line"><span class="n">identifier</span> <span class="o">::=</span> <span class="sc">&#39;X&#39;</span> <span class="sc">&#39;o&#39;</span> <span class="n">operator</span><span class="o">-</span><span class="n">fixity</span> <span class="n">natural</span> <span class="n">identifier</span><span class="o">-</span><span class="kt">char</span><span class="o">*</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
包含非ASCII字符都使用在RFC 3492中指定Punycode算法编码，与该_用作编码定界符的修改和大写字母A至J标识符被用来代替数字0至9中的编码字符集。是混淆然后由一个X后跟编码串的游程长度和所述编码的字符串本身。例如，标识符vergüenza被错位到X12vergenza_JFa。 （在标准的Punycode编码是vergenza-95A）

包含非ASCII字符，运营商首先映射ASCII运营字符的字母作为纯ASCII运营商名称错位，然后Punycode码编码取代字符串。是混淆然后由XO后跟的固定性，该编码串的运行长度，以及编码的字符串本身。例如，管道符“+”的错位，以Xoi7p_qcaDc（p_qcaDc是的替代字符串“P»编码）。

<h4>代替</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">substitution</span> <span class="o">::=</span> <span class="sc">&#39;S&#39;</span> <span class="n">index</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<substitution>是一个向后引用到先前错位实体。该重整算法维护实体的映射来替代指标，因为它运行。时，可以通过取代（的模块，名义类型或协议）来表示一个实体是错位，一个取代是第一所期望的是取代的地图，并且如果存在，该实体使用相关替代索引错位。否则，该实体通常错位，且随后添加到替代地图，并与下一个可利用的取代索引相关联。
例如，在重整函数类型（zim.zang.zung，zim.zang.zung，zim.zippity） - &gt; zim.zang.zoo（与模块ZIM和类zim.zang），重复上下文ZIM，以星。臧和zim.zang.zung将使用替代被错位的第一次后，被截断。第一个参数类型将在长形裂伤，CC3zim4zang4zung，并在这样做，ZIM将获得替代S_，zim.zang将获得替代S0_，并zim.zang.zung将收购S1_。第二个参数是一样的第一和裂伤将利用其替换，CS1_。第三个参数类型将裂伤使用替代ZIM，CS_7zippity。 （它也获得替代S2_这将被使用，如果再次错位。）结果类型将裂伤使用替代zim.zang，CS0_zoo（并获得替代S3_）。全功能型因而轧液作为fTCC3zim4zang4zungCS1_CS_7zippity_CS0_zoo。
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">substitution</span> <span class="o">::=</span> <span class="sc">&#39;s&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
在特殊的替换s被用于Swift标准库模块。

<h4>预定义替换</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">module</span> <span class="o">::=</span> <span class="sc">&#39;s&#39;</span>                       <span class="c1">// Swift</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">module</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">SC</span><span class="err">&#39;</span>                      <span class="c1">// C</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">module</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">So</span><span class="err">&#39;</span>                      <span class="c1">// Objective-C</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sa</span><span class="err">&#39;</span>                <span class="c1">// Swift.Array</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sb</span><span class="err">&#39;</span>                <span class="c1">// Swift.Bool</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sc</span><span class="err">&#39;</span>                <span class="c1">// Swift.UnicodeScalar</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sd</span><span class="err">&#39;</span>                <span class="c1">// Swift.Float64</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sf</span><span class="err">&#39;</span>                <span class="c1">// Swift.Float32</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Si</span><span class="err">&#39;</span>                <span class="c1">// Swift.Int</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">SP</span><span class="err">&#39;</span>                <span class="c1">// Swift.UnsafePointer</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sp</span><span class="err">&#39;</span>                <span class="c1">// Swift.UnsafeMutablePointer</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">SQ</span><span class="err">&#39;</span>                <span class="c1">// Swift.ImplicitlyUnwrappedOptional</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sq</span><span class="err">&#39;</span>                <span class="c1">// Swift.Optional</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">SR</span><span class="err">&#39;</span>                <span class="c1">// Swift.UnsafeBufferPointer</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Sr</span><span class="err">&#39;</span>                <span class="c1">// Swift.UnsafeMutableBufferPointer</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">SS</span><span class="err">&#39;</span>                <span class="c1">// Swift.String</span>
</span><span class="line"><span class="n">known</span><span class="o">-</span><span class="n">nominal</span><span class="o">-</span><span class="n">type</span> <span class="o">::=</span> <span class="err">&#39;</span><span class="n">Su</span><span class="err">&#39;</span>                <span class="c1">// Swift.UInt</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<known-module> 以及 <known-nominal-type>是内置的替换对于某些常见的实体。像任何其他的替代，他们都以&#8217;S&#8217;。
Objective-C的模块作为上下文重整Objective-C类为的<type>。

<h4>索引</h4>
<p>
<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="objc"><span class="line"><span class="n">index</span> <span class="o">::=</span> <span class="sc">&#39;_&#39;</span>                              <span class="c1">// 0</span>
</span><span class="line"><span class="n">index</span> <span class="o">::=</span> <span class="n">natural</span> <span class="sc">&#39;_&#39;</span>                      <span class="c1">// N+1</span>
</span><span class="line"><span class="n">natural</span> <span class="o">::=</span> <span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
<index>是一个生产环境中不能在一个数字结尾的数字编码;它的编码数量较少的优化。


<p class="post-footer">
                        written by <a href="http://ITMonkeyLife.github.io/Blog">Rick</a>&nbsp;posted at <a href="http://ITMonkeyLife.github.io/Blog">http://ITMonkeyLife.github.io/Blog</a></p>
</index></p></type></known-nominal-type></known-module></p></substitution></p></identifier></p></protocol-conformance></p></type></impl-function-attribute></type></type></type></type></p></实现了一套功能型></reabstract-signature></private-decl-name></private-decl-name></p></li></ul></p></li></ul></p>
</div>


<div class="meta">
	<div class="date">




</div>
	<div class="tags">


	<a class='category' href='/Blog/blog/categories/swift/'>Swift</a>


</div>
	
	<div class="comments"><a href="#disqus_thread">Comments</a></div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		
		<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
		
		
	</div>
	
</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2016

    Rick

</footer>
	<script src="/Blog/javascripts/slash.js"></script>
<script src="/Blog/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'ITMonkeyLife';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ITMonkeyLife.github.io/Blog/blog/2015/12/11/swift-2-dot-2-yuan-ma-jie-du/';
        var disqus_url = 'http://ITMonkeyLife.github.io/Blog/blog/2015/12/11/swift-2-dot-2-yuan-ma-jie-du/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-52658428-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>